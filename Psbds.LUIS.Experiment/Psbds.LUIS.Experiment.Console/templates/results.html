<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>


    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.10.16/datatables.min.css" />

    <script src="http://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.10.16/datatables.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.bundle.min.js" integrity="sha384-lZmvU/TzxoIQIOD9yQDEpvxp6wEU32Fy0ckUgOH4EIlMOCdR823rg4+3gWRwnX1M" crossorigin="anonymous"></script>
</head>
<body>
    <div class="container-fluid">
        <h3>Experiment Results <hr /></h3>
        <table id="example" class="display" style="width:100%">
            <thead>
                <tr>
                    <th width="30px">#</th>
                    <th width="50px">Confusions</th>
                    <th width="300px">Expected Intent</th>
                    #CONFUSION_HEADERS#
                </tr>
            </thead>
        </table>
    </div>
    <script>
        function format(d) {
            $('[data-toggle="tooltip"]').tooltip();
          var intentColumns = Object.keys(d).filter(function (i) { return i.startsWith("intent") });

            var htmlColumns = "";
            var htmlHeaders = "";
            for (var k in intentColumns) {
                var key = intentColumns[k];
                var rows = "-";
                for (var rk in d["examples_" + key]) {
                    rows += d["examples_" + key][rk] + "<hr/>";
                }
                htmlColumns += "<td style='vertical-align: top'>" + rows + "</td>";
                htmlHeaders += "<td style='vertical-align: top'>" + d[key] + "</td>"
            }
            var table = '<div style="    padding: 5px 0 5px 10px;    background-color: black;    font-size: small;"><table cellpadding="5" cellspacing="0" border="0" style="width:100%">' +
                '<tr>' +
                htmlHeaders +
                '</tr>' +
                '<tr>' +
                htmlColumns
            '</tr>' +
                '</table></div>';
            return table;
        }

        $(document).ready(function () {
            var table = $('#example').DataTable({
                "columns": [
                    {
                        "className": 'details-control',
                        "orderable": false,
                        "data": null,
                        "defaultContent": '<button class="btn btn-sm btn-danger">Open</button>'
                    },
                    { "data": "confusions" },
                    { "data": "expected_intent" },
            #CONFUSION_COLUMNS#
                                ],
            "order": [[1, 'asc']],
            "data": #DATA#
                            });

        // Add event listener for opening and closing details
        $('#example tbody').on('click', 'td.details-control', function () {
            var tr = $(this).closest('tr');
            var row = table.row(tr);

            if (row.child.isShown()) {
                // This row is already open - close it
                row.child.hide();
                tr.removeClass('shown');
            }
            else {
                // Open this row
                row.child(format(row.data())).show();
                tr.addClass('shown');
            }
        });


                        });
    </script>
</body>
</html>